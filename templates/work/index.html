{% extends (craft.app.request.isAjax and not craft.app.request.isLivePreview) ? '_ajax-layout' : '_layout' %}

{% if entry is not defined %}
  {% set entry = craft.entries.section('workIndex').one() %}
{% endif %}

{% set title = entry.title %}
{% if entry.seoTitle %}{% set seoTitle = entry.seoTitle %}{% endif %}
{% if entry.seoDescription %}{% set seoDescription = entry.seoDescription %}{% endif %}
{% set bodyClass = 'single page work with-blobs' %}
{% set bodyDataAttributes = 'data-blob-color=#FF3D00' %}

{% if category is defined %}

  {% set projectEntries = craft.superTable.getRelatedElements({
    relatedTo: {
      targetElement: category,
      field: 'services.service'
    },
    section: 'work'
  }) %}

{% else %}
  {% set projectEntries = craft.entries({
    section: 'work',
    with: [
      'altImage',
      'mainImage'
    ]
  }) %}
{% endif %}

{% block content %}

  {% include 'partials/_text-header' %}

  <div class="container">
    <div class="thumbnail-grid grid spaced">
      {% for projectEntry in projectEntries.all() %}
        {% include 'work/_article' with { entry: projectEntry } %}
      {% endfor %}
    </div>
  </div>

{% endblock %}
