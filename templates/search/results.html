{% extends (craft.app.request.isAjax and not craft.app.request.isLivePreview) ? '_ajax-layout' : '_layout' %}

{% set title = 'Search Results' %}
{% set bodyClass = 'search-results' %}

{% set searchQuery = craft.app.request.getParam('q') %}
{% set entries = craft.entries()
  .search(searchQuery)
  .orderBy('score')
  .with([
    'headerImage',
    'thumbnailImage',
    'altImage',
    'ideasType',
    'services.service',
    'photo'
  ])
  .all() %}

{% block content %}

<div class="results">
  {% if entries|length %}
    <h4 class="heading-smallcaps">{{ entries|length }} results for &ldquo;{{ searchQuery }}&rdquo;</h4>

    <div class="thumbnail-grid grid spaced">
      {% for entry in entries %}
        {% if entry.section.handle == 'work' %}
          {% include 'work/_article' with { entry: entry, servicesLength: 3, classOverride: 'col-nav-1-3' } %}
        {% elseif entry.section.handle == 'ideas' %}
          {% include 'ideas/_article' with { entry: entry, servicesLength: 3, classOverride: 'col-nav-1-3' } %}
        {% elseif entry.section.handle == 'people' %}
          {% include 'people/_article' with { entry: entry, articleClass: 'col-nav-1-3', noModal: 'yeah', cursor: '' } %}
        {% else %}
          {# Temporarily hiding pages + positions
          <article class="page col-nav-1-3 -reveal">
            <div class="meta">
              <h4 class="heading-smallcaps">{{ entry.section.handle in ['people', 'position'] ? entry.section.handle : 'Page' }}</h4>
              <h3><a href="{{ entry.getUrl() }}"><span>{{ entry.title }}</span></a></h3>
            </div>
          </article> #}
        {% endif %}
      {% endfor %}
    </div>
  {% else %}
    <h4 class="heading-smallcaps">Your search for “{{ searchQuery }}” didn’t return any results.</h4>
  {% endif %}
</div>

{% endblock %}